
<script type="text/javascript" src="js/sha/sha.js"></script>
<script type="text/JavaScript" src="js/keygen.js"></script>
<script type="text/JavaScript" src="js/blowfish.js"></script>
<script type="text/JavaScript" src="js/ciphers.js"></script>
<script type="text/javascript">
<!--
	function special(source)
	{
		var result = '';
		for (var i = 0; i < source.length; i++)
		{
			var c = source.charAt(i);
			c = '&#' + c.charCodeAt() + ';';
			result += c;
		}
		return result;
	}


function DecryptP(ciphertext,passbox,hide,salt)
{
	var pass = document.getElementById(passbox).value;
	var ct = document.getElementById(ciphertext).innerHTML;
	var pt = superDecrypt(ct,pass + salt);
	if(pt != "##!!wrong!!##")
	{
		document.getElementById(ciphertext).innerHTML = special(pt);
		document.getElementById(hide).innerHTML = 'Password decrypted.';
	}
	else
	{
		alert('Wrong password!');
	}
}

function EncryptT(text1,text2,txtPass1, txtPass2,divb, inputsalt)
{
	var salt = inputsalt;
	var txt1 = document.getElementById(text1).value;
	var txt2 = document.getElementById(text2).value;
	
	var pass1 = document.getElementById(txtPass1).value;
	var pass2 = document.getElementById(txtPass2).value;
	
	if(txt1 != txt2)
	{
		alert('Passwords do not match (The one you are saving in Password Bolt).');
	}
	else
	{
		if(pass1 != pass2)
		{
			alert('Passwords do not match (The one being used for in-browser encryption).');
		}
		else
		{
			if(pass1.length < 20 && !confirm('The password you are using for in-browser encryption is less then 20 characters, are you sure you want to use a weak password?',2,2))
			{
				alert('Your password has not been encrypted, you may now choose a longer password.');
			}
			else
			{
				//FINALLY we encrypt it.
				var ct = superEncrypt(txt1,pass1 + salt);
				document.getElementById(text1).value = ct;
				document.getElementById(text2).value = ct;
				document.getElementById(text1).type = 'text';
				document.getElementById(text2).type = 'text';
				//document.getElementById(text1).disabled = true;
				//document.getElementById(text2).disabled = true;
				
				//clear the password so it's not being sent to the server!!
				document.getElementById(txtPass1).value = '';
				document.getElementById(txtPass2).value = '';
				//document.getElementById(txtPass1).disabled = true;
				//document.getElementById(txtPass2).disabled = true;
				document.getElementById(divb).innerHTML = '<center>Password Encrypted.</center>';
				document.getElementById('encryptionsalt').value = salt;
				alert('Your password has been encrypted with in-browser encryption');
			}
		}
		
	}

}
-->
</script>
