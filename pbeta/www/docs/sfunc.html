<html>
<head>
<title>Password Bolt - User Manual</title>
<link href="style/main.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Password Bolt - User Manual and Technical Details</h1>
<h2>Cryptographic functions</h2>
<h3>UserHash(username,password,keyfile)</h3><br />
- Salt for generating the token is taken from the account's row in the database<br />
- The token is generated by a SHA256 HMAC of salt keyed with the user's login information.
<br /><br /><h3>UserKey(username,password,keyfile)</h3><br />
- Salt for generating encryption keys is taken from the account's row in the database <br />
- self::makeKey(salt, username + password + keyfile, true); generates the encryption key
<br /><br /><h3>ServerHash(data)</h3><br />
ServerHash runs the data through a SHA256 HMAC keyed with the server's private key
<br /><br /><h3>MySQL's SHA1</h3><br />
This is the standard SHA1 function included with MySQL. It is considered weak, the attacks on it allow collisions to be found faster than normal. It is still secure for it's use in this system because:<br />
- No key is directly run through the algorithm (hashed with a strong hash algorithm first)<br />
- SHA1(SHA1(data) + data) is used, similar to an HMAC<br />
- It only provides authentication, and doesn't generate any kind of encryption key.<br />
If new problems with SHA1 ever make its use in Password Bolt insecure, the MySQL function AESEncrypt(data, data) can be used instead.
<br /><br /><h3>MakeKey(salt, password)</h3><br />
MakeKey combines HMAC-SHA512 and HMAC-WHIRLPOOL of the salt and the first 300 digits of PI to create the first 512 bits of the key. The last 256 bits are created with the first 256 bits of HMAC-SHA512 and HMAC-WHIRLPOOL of salt and the last 300 digits of PI keyed with password. It returns the final 768 bits in hex format.<br />
<pre>

W - the respective byte of the whirlpool hmac with first 300 pi digits.
S - the respective byte of the SHA512 hmac wih first 300 pi digits
X - the respective byte of whirlpool hmac with second 300 pi digits.
T - the respective byte of SHA512 hmac with the second 300 pi digits.
|WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX|
                                              xor
|SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT|

</pre>
<h3>Get256</h3><br />
Get256 generates a psudorandom 256 bit number in hex. It simply uses mt_rand() mod 16 to generate each hex character. It should be considered a weak source of random data. It is good enough for generating initialization vectors for CBC mode encryption.

<br />


<div class="cwrap">
<div id="navbar">
<table border=1>
<tr><td><a href="index.html">0. Introduction</a></td><td><a href="deletepw.html">6. Deleting a password</a></td></tr>
<tr><td><a href="create.html">1. Creating an account</a></td><td><a href="rng.html">7. Random password generator</a></td></tr>
<tr><td><a href="login.html">2. Logging in</a></td><td><a href="notepad.html">8. Using the notepad</a></td></tr>
<tr><td><a href="addpw.html">3. Adding a password</a></td><td><a href="logout.html">9. Logging out</a></td></tr>
<tr><td><a href="viewpw.html">4. Viewing a password</a></td><td><a href="changeacct.html">10. Changing the account password</a></td></tr>
<tr><td><a href="changepw.html">5. Changing a password</a></td><td><a href="deleteacct.html">11. Deleting the account</a></td></tr>
<tr><td></td><td><a href="sfunc.html">Cryptographic functions</a></td></tr>
</table>
</div>
</div>


</body>
</html>
